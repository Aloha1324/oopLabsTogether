{
  "info": {
    "_postman_id": "lab5-universal-collection",
    "name": "LAB5 Universal API Collection",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –¥–ª—è Manual (Servlets) –∏ Framework (Spring Boot) –≤–µ—Ç–æ–∫"
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ–º base_url –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç api_type",
          "const apiType = pm.environment.get('api_type');",
          "",
          "if (apiType === 'manual') {",
          "    pm.environment.set('base_url', pm.environment.get('base_url_manual'));",
          "    console.log('üõ†Ô∏è –†–µ–∂–∏–º: Manual (Servlets)');",
          "    console.log('üåê Base URL: ' + pm.environment.get('base_url_manual'));",
          "} else if (apiType === 'framework') {",
          "    pm.environment.set('base_url', pm.environment.get('base_url_framework'));",
          "    console.log('‚ö° –†–µ–∂–∏–º: Framework (Spring Boot)');",
          "    console.log('üåê Base URL: ' + pm.environment.get('base_url_framework'));",
          "} else {",
          "    console.error('‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π api_type. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ \"manual\" –∏–ª–∏ \"framework\"');",
          "}"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// –ë–∞–∑–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤",
          "console.log('üìä –ó–∞–ø—Ä–æ—Å: ' + pm.info.requestName);",
          "console.log('üéØ –°—Ç–∞—Ç—É—Å: ' + pm.response.code + ' ' + pm.response.status);",
          "console.log('‚è±Ô∏è  –í—Ä–µ–º—è: ' + pm.response.responseTime + 'ms');",
          "",
          "// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–¥–∞",
          "pm.test('–°—Ç–∞—Ç—É—Å –∫–æ–¥ 2xx, 404 –∏–ª–∏ 405', function() {",
          "    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204, 400, 401, 403, 404, 405]);",
          "});",
          "",
          "// –ü—Ä–æ–≤–µ—Ä–∫–∞ Content-Type –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤",
          "if (pm.response.code === 200 || pm.response.code === 201) {",
          "    pm.test('–û—Ç–≤–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON', function() {",
          "        const contentType = pm.response.headers.get('Content-Type');",
          "        pm.expect(contentType).to.include('application/json');",
          "    });",
          "    ",
          "    // –õ–æ–≥–∏—Ä—É–µ–º —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ –≤ debug —Ä–µ–∂–∏–º–µ",
          "    const debugMode = pm.environment.get('debug_mode') === 'true';",
          "    if (debugMode) {",
          "        try {",
          "            const responseBody = pm.response.json();",
          "            console.log('üì¶ –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞:');",
          "            console.log(JSON.stringify(responseBody, null, 2));",
          "        } catch (e) {",
          "            console.log('üì¶ –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ (–Ω–µ JSON): ' + pm.response.text());",
          "        }",
          "    }",
          "}",
          "",
          "// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫",
          "if (pm.response.code >= 400) {",
          "    console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ ' + pm.response.code + ':');",
          "    try {",
          "        const errorText = pm.response.text();",
          "        if (errorText && errorText.length > 0) {",
          "            if (errorText.includes('{')) {",
          "                const errorJson = JSON.parse(errorText);",
          "                console.warn(JSON.stringify(errorJson, null, 2));",
          "            } else {",
          "                console.warn(errorText.substring(0, 500) + (errorText.length > 500 ? '...' : ''));",
          "            }",
          "        }",
          "    } catch (e) {",
          "        console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –æ—à–∏–±–∫—É');",
          "    }",
          "}"
        ]
      }
    }
  ],
  "variable": [],
  "item": [
    {
      "name": "üîß Health Check & Setup",
      "item": [
        {
          "name": "üîÑ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API —Ç–∏–ø–∞",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/",
              "host": ["{{base_url}}"],
              "path": [""]
            }
          }
        },
        {
          "name": "üìÑ GET Main Page",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:8080/LAB5/",
              "host": ["http://localhost:8080"],
              "path": ["LAB5", ""]
            }
          }
        }
      ]
    },
    {
      "name": "üë• Users API",
      "description": "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏",
      "item": [
        {
          "name": "üîπ USERS-1: GET All Users (Admin only)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/users",
              "host": ["{{base_url}}"],
              "path": ["users"]
            }
          }
        },
        {
          "name": "üîπ USERS-2: GET User by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/users/1",
              "host": ["{{base_url}}"],
              "path": ["users", "1"]
            }
          }
        },
        {
          "name": "üîπ USERS-3: GET User by Login",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/users/login/admin",
              "host": ["{{base_url}}"],
              "path": ["users", "login", "admin"]
            }
          }
        },
        {
          "name": "üîπ USERS-4: GET Users by Role",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/users/role/ADMIN",
              "host": ["{{base_url}}"],
              "path": ["users", "role", "ADMIN"]
            }
          }
        },
        {
          "name": "üîπ USERS-5: POST Create User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"login\": \"{{test_user_login}}\",\n  \"password\": \"{{test_user_password}}\",\n  \"role\": \"{{test_user_role}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/users",
              "host": ["{{base_url}}"],
              "path": ["users"]
            }
          }
        },
        {
          "name": "üîπ USERS-6: PUT Update User",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"login\": \"updated_{{test_user_login}}\",\n  \"role\": \"ADMIN\",\n  \"password\": \"newpassword123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/users/1",
              "host": ["{{base_url}}"],
              "path": ["users", "1"]
            }
          }
        },
        {
          "name": "üîπ USERS-7: DELETE User",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/users/1",
              "host": ["{{base_url}}"],
              "path": ["users", "1"]
            }
          }
        }
      ]
    },
    {
      "name": "üìà Functions API",
      "description": "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏—è–º–∏",
      "item": [
        {
          "name": "üîπ FUNC-1: GET All Functions (Admin only)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/functions",
              "host": ["{{base_url}}"],
              "path": ["functions"]
            }
          }
        },
        {
          "name": "üîπ FUNC-2: GET Function by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/functions/1",
              "host": ["{{base_url}}"],
              "path": ["functions", "1"]
            }
          }
        },
        {
          "name": "üîπ FUNC-3: GET Functions by User ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/functions/user/1",
              "host": ["{{base_url}}"],
              "path": ["functions", "user", "1"]
            }
          }
        },
        {
          "name": "üîπ FUNC-4: GET Functions by Name",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/functions/name/quadratic",
              "host": ["{{base_url}}"],
              "path": ["functions", "name", "quadratic"]
            }
          }
        },
        {
          "name": "üîπ FUNC-5: GET Function Statistics",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/functions/stats/1",
              "host": ["{{base_url}}"],
              "path": ["functions", "stats", "1"]
            }
          }
        },
        {
          "name": "üîπ FUNC-6: POST Create Function",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": 1,\n  \"name\": \"Quadratic Function\",\n  \"signature\": \"x^2\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/functions",
              "host": ["{{base_url}}"],
              "path": ["functions"]
            }
          }
        },
        {
          "name": "üîπ FUNC-7: PUT Update Function",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Updated Function\",\n  \"signature\": \"x^3 + 2x\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/functions/1",
              "host": ["{{base_url}}"],
              "path": ["functions", "1"]
            }
          }
        },
        {
          "name": "üîπ FUNC-8: DELETE Function",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/functions/1",
              "host": ["{{base_url}}"],
              "path": ["functions", "1"]
            }
          }
        }
      ]
    },
    {
      "name": "üìç Points API",
      "description": "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—á–∫–∞–º–∏ —Ñ—É–Ω–∫—Ü–∏–π",
      "item": [
        {
          "name": "üîπ POINT-1: GET Points by Function ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/points/function/1",
              "host": ["{{base_url}}"],
              "path": ["points", "function", "1"]
            }
          }
        },
        {
          "name": "üîπ POINT-2: GET Point by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/points/1",
              "host": ["{{base_url}}"],
              "path": ["points", "1"]
            }
          }
        },
        {
          "name": "üîπ POINT-3: GET Max Y Point",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/points/max/1",
              "host": ["{{base_url}}"],
              "path": ["points", "max", "1"]
            }
          }
        },
        {
          "name": "üîπ POINT-4: GET Min Y Point",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/points/min/1",
              "host": ["{{base_url}}"],
              "path": ["points", "min", "1"]
            }
          }
        },
        {
          "name": "üîπ POINT-5: GET Points Statistics",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/points/stats/1",
              "host": ["{{base_url}}"],
              "path": ["points", "stats", "1"]
            }
          }
        },
        {
          "name": "üîπ POINT-6: POST Create Point",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"functionId\": 1,\n  \"xValue\": 2.5,\n  \"yValue\": 6.25\n}"
            },
            "url": {
              "raw": "{{base_url}}/points",
              "host": ["{{base_url}}"],
              "path": ["points"]
            }
          }
        },
        {
          "name": "üîπ POINT-7: POST Generate Points",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"functionType\": \"QUADRATIC\",\n  \"start\": -10,\n  \"end\": 10,\n  \"step\": 0.5\n}"
            },
            "url": {
              "raw": "{{base_url}}/points/generate/1",
              "host": ["{{base_url}}"],
              "path": ["points", "generate", "1"]
            }
          }
        },
        {
          "name": "üîπ POINT-8: PUT Update Point",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"xValue\": 3.0,\n  \"yValue\": 9.0\n}"
            },
            "url": {
              "raw": "{{base_url}}/points/1",
              "host": ["{{base_url}}"],
              "path": ["points", "1"]
            }
          }
        },
        {
          "name": "üîπ POINT-9: DELETE Point",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic {{auth_header}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/points/1",
              "host": ["{{base_url}}"],
              "path": ["points", "1"]
            }
          }
        }
      ]
    },
    {
      "name": "‚öôÔ∏è –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏",
      "description": "–ì–æ—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è",
      "item": [
        {
          "name": "üìã –°—Ü–µ–Ω–∞—Ä–∏–π 1: Basic Auth –ø—Ä–æ–≤–µ—Ä–∫–∞",
          "item": [
            {
              "name": "1. GET –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 401)",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/users",
                  "host": ["{{base_url}}"],
                  "path": ["users"]
                }
              }
            },
            {
              "name": "2. GET —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 200 –∏–ª–∏ 403)",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Basic {{auth_header}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/users",
                  "host": ["{{base_url}}"],
                  "path": ["users"]
                }
              }
            }
          ]
        },
        {
          "name": "üìä –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ API",
          "item": [
            {
              "name": "1. –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "http://localhost:8080/LAB5/",
                  "host": ["http://localhost:8080"],
                  "path": ["LAB5", ""]
                }
              }
            },
            {
              "name": "2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π)",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Basic {{auth_header}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/users",
                  "host": ["{{base_url}}"],
                  "path": ["users"]
                }
              }
            },
            {
              "name": "3. –§—É–Ω–∫—Ü–∏–∏ (—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π)",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Basic {{auth_header}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/functions",
                  "host": ["{{base_url}}"],
                  "path": ["functions"]
                }
              }
            }
          ]
        }
      ]
    }
  ]
}